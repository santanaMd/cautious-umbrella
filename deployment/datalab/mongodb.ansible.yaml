#
##
### MongoDB
##
#

- name: Instalar o chart Mongo usando Helm
  community.kubernetes.helm:
    chart_ref: oci://registry-1.docker.io/bitnamicharts/mongodb
    release_name: datalab-mongo
    namespace: datalab
    create_namespace: true
    release_state: present
    chart_version: "{{ mongodb_datalab_chart_version }}"
    values:
      global:
        security:
          allowInsecureImages: true
      image:
        registry: docker.io
        repository: amd64/mongo
        tag: latest
      architecture: standalone
      tls:
        enabled: false
        mTLS:
          enabled: false
        autoGenerated: true
      persistence:
        enabled: true
        mountPath: "/data/db"
        storageClass: "local-path"
        accessModes:
          - ReadWriteOnce
        size: 40Gi
      metrics:
        enabled: true
      auth:
        enabled: true
        rootUser: root
        rootPassword: "{{ mongodb_datalab_root_passwd }}"